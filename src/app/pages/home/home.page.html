<ion-header [translucent]="true" class="safe-area-horizontal">
  <ion-toolbar>
    <ion-title>SignalsMaster</ion-title>
    <ion-buttons slot="end">
      <ion-button *ngIf="isAuthenticated" (click)="navigateToProfile()">
        <ion-icon slot="icon-only" name="person-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- FIX: Removed [fullscreen]="true" to prevent iOS scrolling conflicts. -->
<ion-content class="safe-area-padding">
  <div class="container">
    <!-- Fix Issue #251: Warning banner when Firebase Auth unavailable -->
    <ion-card *ngIf="!firebaseAuthAvailable" color="warning" class="auth-warning">
      <ion-card-content>
        <div style="display: flex; align-items: center; gap: 8px;">
          <ion-icon name="warning-outline" style="font-size: 24px;"></ion-icon>
          <div>
            <strong>Limited Mode</strong><br>
            <small>Some features unavailable. Practice results will not sync.</small>
          </div>
        </div>
      </ion-card-content>
    </ion-card>

    <!-- User Authentication Section -->
    <div class="auth-section" *ngIf="!isAuthenticated">
      <div class="auth-card">
        <h3>Welcome to SignalsMaster</h3>
        <p>Create your profile to track progress and compete on the leaderboard</p>
        <ion-button expand="block" fill="solid" (click)="navigateToRegistration()">
          Create Profile
        </ion-button>
      </div>
    </div>

    <div class="user-welcome" *ngIf="isAuthenticated && currentUser">
      <app-user-badge [user]="currentUser" size="medium"></app-user-badge>
    </div>

    <!-- Hero Section -->
    <div class="text-center mb-12">
      <h2>Signals Master</h2>
      <p>
        Master flag recognition and signaling. Practice at your own pace or compete for the top spot!
      </p>
    </div>

    <!-- Mode Selection Cards -->
    <div class="space-y-6 mb-8">
      <!-- Practice Mode Card -->
      <div class="card-mode">
        <div class="flex">
          <div class="icon-container practice">üìö</div>
          <div class="flex-1">
            <h2>Practice Mode</h2>
            <p>Learn at your own pace with no pressure</p>
          </div>
        </div>
        <ion-button
          expand="block"
          fill="solid"
          color="primary"
          (click)="navigateToPracticeMode()"
        >
          Start Practice
        </ion-button>
      </div>

      <!-- Best Signaller Mode Card -->
      <div class="card-mode">
        <div class="flex">
          <div class="icon-container competition">‚≠ê</div>
          <div class="flex-1">
            <h2>Best Signaller</h2>
            <p>Compete globally and climb the leaderboard</p>
          </div>
        </div>
        <ion-button
          expand="block"
          fill="solid"
          color="warning"
          (click)="navigateToBestSignaller()"
        >
          Start Competition
        </ion-button>
      </div>
    </div>

    <!-- Quick Links Section - FIX: stack layout instead of vertical -->
    <div class="cta-section">
      <button class="leaderboard-link" (click)="navigateToLeaderboard()">
        View Leaderboard ‚Üí
      </button>
      <div class="divider"></div>
      <button class="feedback-link" (click)="navigateToFeedback()">
        <ion-icon name="chatbubbles-outline"></ion-icon>
        <span>Share Your Feedback</span>
      </button>
    </div>
  </div>
</ion-content>


