// ============================================================================
// RESPONSIVE UTILITIES & BREAKPOINT HELPERS
// ============================================================================

// Responsive breakpoints (matching Tailwind config)
$breakpoint-xs: 320px;
$breakpoint-sm: 375px;   // Primary mobile target
$breakpoint-md: 600px;   // Tablet start
$breakpoint-lg: 768px;   // Tablet optimized
$breakpoint-xl: 1024px;  // Desktop start
$breakpoint-2xl: 1200px; // Full desktop
$breakpoint-3xl: 1280px; // Large desktop
$breakpoint-4xl: 1440px; // Ultra-wide
$breakpoint-5xl: 1600px; // Max desktop

// ============================================================================
// MOBILE-FIRST RESPONSIVE HELPERS
// ============================================================================

// Utility classes for responsive visibility
.hidden-mobile {
  @media (max-width: 599px) {
    display: none !important;
  }
}

.hidden-tablet {
  @media (min-width: 600px) and (max-width: 999px) {
    display: none !important;
  }
}

.hidden-desktop {
  @media (min-width: 1000px) {
    display: none !important;
  }
}

.visible-mobile {
  display: none !important;

  @media (max-width: 599px) {
    display: block !important;
  }
}

.visible-tablet {
  display: none !important;

  @media (min-width: 600px) and (max-width: 999px) {
    display: block !important;
  }
}

.visible-desktop {
  display: none !important;

  @media (min-width: 1000px) {
    display: block !important;
  }
}

// ============================================================================
// CONTAINER RESPONSIVE ADJUSTMENTS
// ============================================================================

.container-responsive {
  width: 100%;
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--spacing-md);
  padding-right: var(--spacing-md);

  @media (min-width: 375px) {
    padding-left: var(--spacing-lg);
    padding-right: var(--spacing-lg);
  }

  @media (min-width: 768px) {
    padding-left: var(--spacing-xl);
    padding-right: var(--spacing-xl);
    max-width: 750px;
  }

  @media (min-width: 992px) {
    max-width: 970px;
  }

  @media (min-width: 1200px) {
    max-width: 1170px;
    padding-left: 60px;
    padding-right: 60px;
  }

  @media (min-width: 1280px) {
    max-width: 1240px;
    padding-left: 70px;
    padding-right: 70px;
  }

  @media (min-width: 1440px) {
    max-width: 1440px; // Max container width for ultra-wide screens
    padding-left: 80px;
    padding-right: 80px;
  }

  @media (min-width: 1600px) {
    max-width: 1440px; // Lock at 1440px for readability
    padding-left: 100px;
    padding-right: 100px;
  }
}

// ============================================================================
// RESPONSIVE GRID HELPERS
// ============================================================================

.grid-responsive {
  display: grid;
  gap: var(--spacing-lg);

  // Mobile: 1 column
  grid-template-columns: 1fr;

  // Tablet: 2 columns
  @media (min-width: 600px) {
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-xl);
  }

  // Desktop: 3 columns
  @media (min-width: 1000px) {
    grid-template-columns: repeat(3, 1fr);
  }
}

.grid-2col-responsive {
  display: grid;
  gap: var(--spacing-lg);
  grid-template-columns: 1fr;

  @media (min-width: 600px) {
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-xl);
  }

  @media (min-width: 1200px) {
    gap: var(--spacing-2xl);
  }
}

// ============================================================================
// RESPONSIVE TEXT HELPERS
// ============================================================================

.text-responsive-lg {
  font-size: 18px;

  @media (min-width: 768px) {
    font-size: 20px;
  }

  @media (min-width: 1200px) {
    font-size: 24px;
  }

  @media (min-width: 1280px) {
    font-size: 26px;
  }

  @media (min-width: 1440px) {
    font-size: 28px;
  }
}

.text-responsive-sm {
  font-size: 14px;

  @media (min-width: 768px) {
    font-size: 15px;
  }

  @media (min-width: 1200px) {
    font-size: 16px;
  }

  @media (min-width: 1280px) {
    font-size: 17px;
  }

  @media (min-width: 1440px) {
    font-size: 18px;
  }
}

// ============================================================================
// RESPONSIVE SPACING HELPERS
// ============================================================================

.py-responsive {
  padding-top: var(--spacing-xl);
  padding-bottom: var(--spacing-xl);

  @media (min-width: 768px) {
    padding-top: var(--spacing-2xl);
    padding-bottom: var(--spacing-2xl);
  }

  @media (min-width: 1200px) {
    padding-top: var(--spacing-3xl);
    padding-bottom: var(--spacing-3xl);
  }
}

.gap-responsive {
  gap: var(--spacing-lg);

  @media (min-width: 768px) {
    gap: var(--spacing-xl);
  }

  @media (min-width: 1200px) {
    gap: var(--spacing-2xl);
  }
}

// ============================================================================
// SAFE AREA PADDING (for notched devices)
// ============================================================================

.safe-area-padding {
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
  padding-top: env(safe-area-inset-top, 0);
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.safe-area-horizontal {
  padding-left: env(safe-area-inset-left, 0);
  padding-right: env(safe-area-inset-right, 0);
}

// ============================================================================
// RESPONSIVE DISPLAY HELPERS
// ============================================================================

.flex-responsive {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-lg);

  @media (min-width: 768px) {
    flex-direction: row;
    gap: var(--spacing-xl);
  }
}

.flex-wrap-responsive {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-md);

  @media (min-width: 768px) {
    gap: var(--spacing-lg);
  }

  @media (min-width: 1200px) {
    gap: var(--spacing-xl);
  }
}

// ============================================================================
// DESKTOP FOOTER/TABS ENHANCEMENT
// ============================================================================

@media (min-width: 768px) {
  ion-tabs {
    display: flex !important;
    flex-direction: column !important;
    box-shadow: 0 -2px 8px rgba(10, 42, 67, 0.1);

    ion-tab-bar {
      display: flex !important;
      visibility: visible !important;
      opacity: 1 !important;
      // Removed max-width and margin to allow tab bar to stretch edge-to-edge on desktop, addressing footer/tab stretch issue.
      width: 100%;
      /* Use fixed positioning across viewports for predictable layout; avoid
        sticky that can be constrained by parent containers. This ensures the
        tab bar is visually flush to the bottom on desktop. */
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
    }

    ion-tab-button {
      display: inline-flex !important;
      visibility: visible !important;
      opacity: 1 !important;
    }
  }
}

// ============================================================================
// RESPONSIVE MAX-WIDTH CONSTRAINTS
// ============================================================================

.max-w-sm {
  max-width: 400px;
}

.max-w-md {
  max-width: 600px;
}

.max-w-lg {
  max-width: 800px;
}

.max-w-xl {
  max-width: 1000px;
}

.max-w-2xl {
  max-width: 1200px;
}

.max-w-3xl {
  max-width: 1440px; // Ultra-wide desktop max
}

.max-w-full {
  max-width: 100%;
}

// ============================================================================
// CENTER CONTENT HELPERS
// ============================================================================

.centered {
  margin-left: auto;
  margin-right: auto;
}

.flex-center {
  display: flex;
  justify-content: center;
  align-items: center;
}

// ============================================================================
// TRUNCATE HELPERS
// ============================================================================

.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.truncate-2 {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  line-clamp: 2;
  overflow: hidden;
}

.truncate-3 {
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  line-clamp: 3;
  overflow: hidden;
}

// ============================================================================
// PLATFORM-SPECIFIC STYLES (iOS & ANDROID)
// ============================================================================

// iOS-Specific Optimizations
body.ios {
  // iOS status bar handling (extra spacing for notched devices)
  ion-header {
    padding-top: env(safe-area-inset-top);
  }

  // iOS-specific button styles (lighter, more rounded)
  ion-button {
    --border-radius: 12px;
    font-weight: 500;
  }

  // Prevent iOS Safari input zoom
  input,
  select,
  textarea {
    font-size: 16px !important; // Prevents auto-zoom
  }

  // iOS scroll physics
  ion-content {
    --offset-bottom: auto !important;
    /* NOTE: Previously set to `hidden` which disables scrolling on iOS webviews
       (ion-content is the primary scroll container in Ionic). This caused
       iOS browsers to be unable to scroll in key pages. Change to `auto`
       to allow native scrolling while preserving other iOS-specific rules. */
    --overflow: auto;
  }

  // iOS-specific safe area for footer/tabs
  ion-footer,
  ion-tabs,
  ion-tab-bar {
    padding-bottom: max(var(--spacing-sm), env(safe-area-inset-bottom));
  }

  // Smooth momentum scrolling
  * {
    -webkit-overflow-scrolling: touch;
  }
}

// Android-Specific Optimizations
body.android,
body.md {
  // Material Design button styles
  ion-button {
    --border-radius: 4px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  // Android ripple effect enhancement
  ion-button,
  .option-button,
  .card-mode {
    --ripple-color: rgba(0, 0, 0, 0.1);
  }

  // Android status bar handling
  ion-header {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  // Material elevation for cards
  .card,
  .card-mode,
  .hero-card {
    box-shadow:
      0 2px 4px rgba(0, 0, 0, 0.12),
      0 1px 2px rgba(0, 0, 0, 0.08);
  }
}

// Mobile-Specific Optimizations (Both Platforms)
body.mobile {
  // Larger touch targets for mobile
  .option-button,
  ion-button {
    min-height: 52px; // Slightly larger than 48px for comfort on mobile
  }

  // Mobile font scaling
  body {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  // Prevent text selection on mobile for UI elements
  .metadata-bar,
  .quiz-header,
  ion-toolbar {
    -webkit-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
}

// Hybrid App Optimizations (Native Capacitor Apps)
body.hybrid {
  // Disable text selection for better native feel
  * {
    -webkit-tap-highlight-color: transparent;
  }

  // Performance optimization for animations
  .flag-container,
  .option-button,
  .feedback-overlay {
    will-change: transform, opacity;
    transform: translateZ(0);
  }
}
